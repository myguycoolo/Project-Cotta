"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.webpackCliInitTask = void 0;
const just_task_1 = require("just-task");
const tryRequire_1 = require("../tryRequire");
/**
 * webpackCliInitTask - task for webpack-cli init command
 *
 * @param customScaffold - to pass any webpack-scaffold
 * @param auto - to pass the --auto flag, which will generate a default webpack.config.js
 */
function webpackCliInitTask(customScaffold, auto = false) {
    return function webpackCli() {
        const init = tryRequire_1.tryRequire('@webpack-cli/init').default;
        if (!init) {
            just_task_1.logger.warn('webpack-cli init requires three dependencies: @webpack-cli/init (preferred - as a devDependency)');
            return;
        }
        just_task_1.logger.info(`Running Webpack-cli init `);
        if (typeof customScaffold === 'undefined') {
            if (auto) {
                try {
                    init(null, null, null, '--auto');
                }
                catch (error) {
                    throw `Webpack-cli init failed with ${error.length} error(s).`;
                }
            }
            else {
                try {
                    init();
                }
                catch (error) {
                    throw `Webpack-cli init failed with ${error.length} error(s).`;
                }
            }
        }
        else {
            just_task_1.logger.info(`Running the Scaffold ${customScaffold}`);
            try {
                init(null, null, customScaffold);
            }
            catch (error) {
                throw `Webpack-cli init failed with ${error.length} error(s).`;
            }
        }
    };
}
exports.webpackCliInitTask = webpackCliInitTask;
//# sourceMappingURL=webpackCliInitTask.js.map